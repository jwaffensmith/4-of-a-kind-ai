# 4 of a Kind AI

An AI-powered word puzzle game where players find groups of four words that share common themes. Puzzles are generated by OpenAI GPT-5.1 featuring diverse categories and increasing difficulty levels.

> **Note**: This project was built as a vibe coding project with Cursor AI, showcasing rapid full-stack development through prompt engineering.

## ğŸ® Features

### Game Play
- **AI-Generated Puzzles**: OpenAI GPT-5.1 creates unique puzzles with diverse category themes
- **4 Difficulty Levels**: Easy (Yellow), Medium (Green), Tricky (Blue), Hard (Purple)
- **Smart Hints**: "One away" detection when 3 out of 4 words are correct
- **Daily Puzzles**: Featured puzzle of the day
- **Anonymous Play**: No login required - play immediately
- **Local Stats**: Game history persisted in browser localStorage

### Statistics & Leaderboard
- **Personal Stats**: Track wins, streaks, averages
- **Global Leaderboard**: Top players ranked by wins
- **Username Sync**: Optional username to sync local stats to database

### Admin Dashboard
- **Puzzle Generation**: Generate puzzles with AI (100/day limit)
- **Review Workflow**: Approve or reject generated puzzles
- **Daily Puzzle Management**: Set featured puzzle from approved puzzles
- **Analytics**: View system stats and admin logs
- **Token Authentication**: Secure admin access with 24-hour sessions

## ğŸ—ï¸ Architecture

### Tech Stack
**Backend:**
- Node.js with TypeScript
- Express.js (REST API)
- Prisma ORM (PostgreSQL)
- OpenAI GPT-5.2 (OpenAI SDK)
- Zod (validation)

**Frontend:**
- React 19 with TypeScript
- Vite (build tool)
- Tailwind CSS v4
- Framer Motion (animations)
- React Router v6

**Infrastructure:**
- Docker & Docker Compose
- PostgreSQL database

### Layered Architecture

```
Client â†’ Routes â†’ Controllers â†’ Services â†’ Repositories â†’ Database
                        â†“
                   OpenAI GPT-5.1
```

**Layer Responsibilities:**
- **Controllers**: Handle HTTP requests/responses
- **Services**: Business logic and orchestration
- **Repositories**: Data access with Prisma
- **Middleware**: Authentication, validation, error handling

## ğŸš€ Quick Start

### Prerequisites
- Docker & Docker Compose
- Node.js 20+ (for local development)
- OpenAI API key from [OpenAI](https://platform.openai.com/api-keys)

### Installation

1. **Clone the repository**
```bash
git clone <repository-url>
cd 4-of-a-kind-ai
```

2. **Set up environment variables**

Create `.env` file in the root directory:
```bash
DB_PASSWORD=your_secure_password
OPENAI_API_KEY=your_openai_api_key
ADMIN_PASSWORD=your_secure_admin_password_20+_characters
JWT_SECRET=your_random_secret_key_32+_characters
```

3. **Start with Docker Compose**
```bash
docker-compose up
```

This will start:
- PostgreSQL on port 5432
- Backend API on port 3001
- Frontend on port 3000

4. **Run database migrations and seed**
```bash
# In a new terminal
docker exec -it connections_backend sh
npx prisma migrate deploy
npx prisma db seed
exit
```

5. **Access the application**
- Game: http://localhost:3000
- Admin: http://localhost:3000/admin/login
- API: http://localhost:3001

## ğŸ“‹ Usage

### Playing the Game
1. Navigate to http://localhost:3000
2. Click words to select them (4 at a time)
3. Click "Submit" to check if they form a group
4. Find all 4 groups with 4 mistakes or fewer to win

### Admin Access
1. Go to http://localhost:3000/admin/login
2. Enter the admin password from your `.env` file
3. Generate puzzles, review submissions, and manage daily puzzles

### Generating Puzzles
1. Navigate to Admin â†’ Generate
2. Click "Generate Puzzle"
3. Go to Admin â†’ Puzzles to review
4. Approve quality puzzles to make them available for play
5. Set one as the daily puzzle

## ğŸ—„ï¸ Database Schema

### Tables
- **puzzle**: AI-generated puzzles with words, categories, and reasoning
- **game_session**: Individual game sessions with state
- **game_stat**: User statistics and leaderboards
- **daily_puzzle**: Featured puzzle assignments by date
- **admin_log**: Audit trail of admin actions

### Key Fields
```typescript
// Puzzle
{
  words: string[]  // 16 words
  categories: {
    name: string
    words: string[]  // 4 words
    difficulty: 'easy' | 'medium' | 'tricky' | 'hard'
    reasoning: string
  }[]
  ai_reasoning: string
  is_reviewed: boolean  // Approval status
}
```

## ğŸ” Security

### Admin Authentication
- **Token-based**: Password login returns session token
- **24-hour expiration**: Tokens expire after 24 hours
- **Session storage**: Tokens stored in browser sessionStorage
- **Protected routes**: All admin endpoints require valid token

### API Rate Limiting
- **Daily quota**: 100 puzzle generations per day
- **Reset time**: Midnight UTC
- **Quota tracking**: In-memory counter with automatic reset

## ğŸ¨ UI/UX Features

### Accessibility (WCAG 2.2 AA)
- âœ… Keyboard navigation (Tab, Enter, Space, Arrows)
- âœ… ARIA labels and roles
- âœ… Screen reader announcements
- âœ… Focus indicators
- âœ… Color contrast compliance

### Responsive Design
- Mobile-first approach
- Tailwind breakpoints (sm, md, lg, xl)
- Touch-friendly buttons and interactions

### Animations
- Framer Motion for complex animations
- Tailwind CSS for transitions
- Confetti celebration on win
- Smooth word shuffle and group reveals

## ğŸ› ï¸ Development

### Backend Development
```bash
cd backend
npm install
npm run dev  # Runs on port 3001
```

### Frontend Development
```bash
cd frontend
npm install
npm run dev  # Runs on port 3000
```

### Database Migrations
```bash
cd backend
npx prisma migrate dev --name migration_name
npx prisma generate
```

### Seed Data
```bash
cd backend
npm run prisma:seed
```

## ğŸ“ Project Structure

```
4-of-a-kind-ai/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ seed.ts
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ config/          # Configuration
â”‚       â”œâ”€â”€ controllers/     # HTTP handlers
â”‚       â”œâ”€â”€ services/        # Business logic
â”‚       â”œâ”€â”€ repositories/    # Data access
â”‚       â”œâ”€â”€ routes/          # API routes
â”‚       â”œâ”€â”€ middleware/      # Express middleware
â”‚       â”œâ”€â”€ validators/      # Zod schemas
â”‚       â”œâ”€â”€ types/           # TypeScript types
â”‚       â””â”€â”€ utils/           # Utilities
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ Game/       # Game UI
â”‚       â”‚   â”œâ”€â”€ Admin/      # Admin dashboard
â”‚       â”‚   â””â”€â”€ Stats/      # Statistics
â”‚       â”œâ”€â”€ contexts/       # React Context
â”‚       â”œâ”€â”€ hooks/          # Custom hooks
â”‚       â”œâ”€â”€ services/       # API clients
â”‚       â”œâ”€â”€ styles/         # Tailwind CSS
â”‚       â””â”€â”€ types/          # TypeScript types
â””â”€â”€ docker-compose.yml
```

## ğŸ§ª API Endpoints

### Public Endpoints
- `GET /api/game/daily` - Get today's featured puzzle
- `GET /api/game/random` - Get random approved puzzle
- `POST /api/game/start` - Start new game session
- `POST /api/game/submit` - Submit guess
- `GET /api/stats/:username` - Get user stats
- `GET /api/stats/leaderboard/top` - Get leaderboard

### Admin Endpoints (Protected)
- `POST /api/admin/login` - Admin login
- `POST /api/admin/logout` - Admin logout
- `POST /api/admin/puzzle/generate` - Generate puzzle
- `GET /api/admin/puzzle/all` - Get all puzzles
- `PUT /api/admin/puzzle/:id/approve` - Approve puzzle
- `DELETE /api/admin/puzzle/:id/reject` - Reject puzzle
- `POST /api/admin/daily` - Set daily puzzle
- `GET /api/admin/stats` - Get admin stats
- `GET /api/admin/quota` - Get generation quota

## ğŸ¤– AI Integration

### OpenAI API
- **Model**: gpt-5.1
- **Purpose**: Generate diverse puzzle categories
- **Prompt Engineering**: Enforces category diversity across domains

### Diversity Requirements
The AI is prompted to ensure:
- 4 categories span different thematic domains
- Mix of connection types (semantic, functional, wordplay, cultural)
- No repetitive patterns (e.g., all animals, all food)
- Clear reasoning for each category

## ğŸ“Š Monitoring

### Logs
- Structured JSON logging
- Log levels: info, warn, error, debug
- Request/response logging
- Admin action audit trail

### Health Check
```bash
curl http://localhost:3001/health
# Response: {"status":"ok"}
```

## ğŸ› Troubleshooting

### Docker Issues
```bash
# Rebuild containers
docker-compose down
docker-compose build --no-cache
docker-compose up
```

### Database Issues
```bash
# Reset database
docker-compose down -v
docker-compose up
# Then run migrations and seed
```

### Port Conflicts
Edit `docker-compose.yml` to change ports:
```yaml
ports:
  - "3001:3001"  # Change left number
```

## ğŸ“ License

MIT License - see LICENSE file

## ğŸ¤ Contributing

Contributions welcome! Please follow:
1. TypeScript strict mode
2. Minimal comments (self-documenting code)
3. Declarative programming patterns
4. WCAG 2.2 AA accessibility standards

## ğŸ™ Acknowledgments

- NYT Connections for inspiration
- OpenAI GPT-5.1 for AI puzzle generation
- React, Tailwind, and Prisma communities
